--- openscholar/modules/contrib/og/og_ui/og_ui.admin.inc.old	2017-08-02 18:02:17.000000000 -0400
+++ openscholar/modules/contrib/og/og_ui/og_ui.admin.inc.new	2017-08-02 18:02:06.000000000 -0400
@@ -208,6 +208,29 @@
 }
 
 /**
+ * Change site's login method
+ */
+function og_ui_change_login_method($form, &$form_state, $group_type, $gid) {
+
+  $form['group_type'] = array('#type' => 'value', '#value' => $group_type);
+  $form['gid'] = array('#type' => 'value', '#value' => $gid);
+
+  $form['og_user'] = array(
+    '#type' => 'fieldset',
+    '#title' => t('Change login method for %group', array('%group' => $label)),
+  );
+  $form['og_user']['name'] = array(
+    '#type' => 'checkbox',
+    '#title' => t('Site members must login using Harvard Key.'),
+  );
+
+  $form['actions'] = array('#type' => 'actions');
+  $form['actions']['submit'] = array('#type' => 'submit', '#value' => t('Save'));
+
+  return $form;
+}
+
+/**
  * AJAX callback to attach the group membership type fields to the form.
  *
  * Since the controlling logic for populating the form is in the form builder
@@ -246,6 +269,14 @@
 }
 
 /**
+ * Validate handler; Change login method.
+ */
+function og_ui_change_login_method_validate($form, &$form_state) {
+  
+  return true;
+}
+
+/**
  * Submit handler; Add users to group.
  */
 function og_ui_add_users_submit($form, &$form_state) {
@@ -274,6 +305,34 @@
 }
 
 /**
+ * Submit handler; Change login method.
+ */
+function og_ui_change_login_method_submit($form, &$form_state) {
+  $group_type = $form_state['values']['group_type'];
+  $gid = $form_state['values']['gid'];
+  $state = $form_state['values']['state'];
+  $og_membership = $form_state['og_membership'];
+  // Set the user and state.
+  field_attach_submit('og_membership', $og_membership, $form['membership_fields'], $form_state);
+  $account = user_load_by_name($form_state['values']['name']);
+  // Ungroup user, in case they were already registered.
+  og_ungroup($group_type, $gid, 'user', $account);
+
+  $og_membership->etid = $account->uid;
+  $og_membership->state = $state;
+  $og_membership->save();
+  // Assign roles.
+  if (!empty($form_state['values']['roles'])) {
+    foreach ($form_state['values']['roles'] as $rid) {
+      og_role_grant($group_type, $gid, $og_membership->etid, $rid);
+    }
+  }
+
+  $group = entity_load_single($group_type, $gid);
+  drupal_set_message(t('%user has been added to the group %group-title.', array('%user' => format_username($account), '%group-title' => entity_label($group_type, $group))));
+}
+
+/**
  * Add Edit membership form.
  */
 function og_ui_edit_membership($form, &$form_state, $group_type, $gid, $og_membership) {
